(this["webpackJsonptmdb-test-task"]=this["webpackJsonptmdb-test-task"]||[]).push([[0],{69:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),s=a.n(c),o=a(94),i=a(71),u=a(40),d=a(26),l=d.c,j=a(22),g=a(28),b=a(37),m=a.n(b),f=a(43),p="d1266c529d5c989c867acb40d8dab16f",O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t){return setTimeout(t,e)}))};function h(){return(h=Object(f.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(500+2e3*Math.random());case 2:if(!(Math.random()>.6)){e.next=4;break}throw new Error("Error for demonstration purposes - retry loading pressing on the desired page number again");case 4:return e.next=6,fetch("https://api.themoviedb.org/3/movie/top_rated?api_key=".concat(p,"&page=").concat(t));case 6:return a=e.sent,e.next=9,a.json();case 9:if(n=e.sent,200===a.status){e.next=12;break}throw new Error("Failed to load movies, because of [".concat(a.status,"] ").concat(n.status_code," ").concat(n.status_message));case 12:return e.abrupt("return",n.results.map((function(e){return{id:e.id,image:"https://image.tmdb.org/t/p/w300/".concat(e.poster_path),title:e.title,overview:e.overview,rating:e.vote_average,year:e.release_date.substr(0,4)}})));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x,v="movies";!function(e){e[e.IDLE=0]="IDLE",e[e.LOADING=1]="LOADING",e[e.SUCCEEDED=2]="SUCCEEDED",e[e.FAILED=3]="FAILED"}(x||(x={}));var w=Object(j.c)({selectId:function(e){return e.id}}),E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.IDLE;return{data:w.getInitialState(),status:e,error:null}},D={currentPageIndex:1,requestedPage:null,pages:{}},I=Object(j.b)("".concat(v,"/fetchMovies"),(function(e){return h.apply(this,arguments)})),C=Object(j.d)({name:v,initialState:D,reducers:{setCurrentPage:function(e,t){e.currentPageIndex=t.payload,e.requestedPage=null}},extraReducers:function(e){e.addCase(I.pending,(function(e,t){var a=t.meta.arg;e.pages[a]||(e.pages[a]=E(x.LOADING)),e.pages[a].status=x.LOADING,e.requestedPage=a})),e.addCase(I.fulfilled,(function(e,t){var a=t.meta.arg,n=e.pages[a];w.addMany(n.data,t.payload),n.status=x.SUCCEEDED,e.requestedPage===a&&(e.currentPageIndex=a)})),e.addCase(I.rejected,(function(e,t){var a=t.meta.arg,n=e.pages[a];n.error=t.error.message||"Request failed",n.status=x.FAILED}))}}),y=C.reducer,S=C.actions,P=function(e){return function(t,a){var n=q(a()),r=n.pages[e];e===n.currentPageIndex&&r&&r.status===x.SUCCEEDED||(r&&r.status===x.SUCCEEDED?t(S.setCurrentPage(e)):r&&![x.IDLE,x.FAILED].includes(r.status)||t(I(e)))}},q=function(e){return e.movies},L=Object(g.a)([q],(function(e){return e.currentPageIndex})),N=Object(g.a)([q],(function(e){return e.requestedPage})),k=Object(g.a)([q,L],(function(e,t){return e.pages[t]||E()})),A=Object(g.a)([q,N],(function(e,t){return"number"===typeof t&&e.pages[t]||E()})),F=Object(g.a)([k],(function(e){return e.status})),R=Object(g.a)([A],(function(e){return e.status})),M=Object(g.a)([A],(function(e){return e.status===x.FAILED?e.error:null})),_=Object(g.a)([k],(function(e){return e.status===x.SUCCEEDED?e.data:w.getInitialState()})),U={selectCurrentPageIndex:L,selectCurrentPageStatus:F,selectMovies:w.getSelectors(_).selectAll,selectRequestedPageError:M,selectRequestedPageIndex:N,selectRequestedPageStatus:R},G=a(89),z=a(95),B=a(90),T=a(91),J=a(92),W=a(3),Y=Object(G.a)({root:{flexGrow:1},title:{fontSize:"2.5vw"},overview:{fontSize:"1.5vw"},textSecondary:{fontSize:"1vw"},poster:{width:"100%"}}),H=function(e){var t=e.data,a=Y(t);return Object(W.jsx)(z.a,{marginY:2,children:Object(W.jsxs)(B.a,{className:a.root,container:!0,spacing:2,component:T.a,alignItems:"stretch",children:[Object(W.jsx)(B.a,{item:!0,xs:2,children:Object(W.jsx)("img",{src:t.image,alt:"",className:a.poster})}),Object(W.jsxs)(B.a,{item:!0,xs:10,container:!0,direction:"column",justify:"space-between",children:[Object(W.jsx)(B.a,{item:!0,children:Object(W.jsx)(J.a,{href:"https://www.themoviedb.org/movie/".concat(t.id),target:"_blank",rel:"noreferrer",children:Object(W.jsx)(i.a,{variant:"body2",className:a.title,children:t.title})})}),Object(W.jsx)(B.a,{item:!0,children:Object(W.jsx)(i.a,{variant:"body2",className:a.overview,children:t.overview})}),Object(W.jsxs)(B.a,{item:!0,container:!0,direction:"row",justify:"space-between",children:[Object(W.jsx)(B.a,{item:!0,children:Object(W.jsxs)(i.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",children:["Year: ",t.year]})}),Object(W.jsx)(B.a,{item:!0,children:Object(W.jsxs)(i.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",align:"right",children:["Rating: ",t.rating]})})]})]})]})})},$=a(96),K=a(39),Q=a(49),V=a(93),X=a(72),Z=a(99),ee=a(100),te=Object(X.a)({wrapper:{display:"grid",gridTemplateColumns:"30px 1fr"},pagination:{display:"block",margin:"0 auto",width:"fit-content"},requested:{border:"1px solid #eee"}}),ae=function(e){var t=e.loading,a=e.requestedPage,n=Object(Q.a)(e,["loading","requestedPage"]),r=te();return Object(W.jsxs)(z.a,{className:r.wrapper,children:[t?Object(W.jsx)(V.a,{size:20}):Object(W.jsx)("div",{}),Object(W.jsx)(ee.a,Object(K.a)({className:r.pagination,siblingCount:2,boundaryCount:2,count:25,shape:"rounded",renderItem:function(e){var t=e.page===a?r.requested:"";return Object(W.jsx)(Z.a,Object(K.a)({className:t},e))}},n))]})},ne=a(98),re=function(){var e=Object(d.b)(),t=l(U.selectCurrentPageIndex),a=l(U.selectMovies),r=l(U.selectCurrentPageStatus),c=l(U.selectRequestedPageIndex),s=l(U.selectRequestedPageStatus),o=l(U.selectRequestedPageError);Object(n.useEffect)((function(){r===x.IDLE&&e(P(t))}),[r,t,e]);var i=Object(n.useState)(!1),j=Object(u.a)(i,2),g=j[0],b=j[1],m=Object(n.useState)("Something went wrong..."),f=Object(u.a)(m,2),p=f[0],O=f[1],h=function(e,t){"clickaway"!==t&&b(!1)};Object(n.useEffect)((function(){s===x.FAILED&&(O(o||"Something went wrong..."),b(!0))}),[c,s,o]);var v=s===x.LOADING,w=Object(W.jsx)(ae,{onChange:function(t,a){e(P(a))},page:t,requestedPage:c,loading:v,defaultPage:1});return Object(W.jsxs)(W.Fragment,{children:[w,Object(W.jsx)($.a,{open:g,autoHideDuration:6e3,onClose:h,children:Object(W.jsx)(ne.a,{onClose:h,severity:"error",children:p})}),r===x.SUCCEEDED&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(z.a,{children:a.map((function(e){return Object(W.jsx)(H,{data:e},e.id)}))}),"pagination"]})]})},ce=function(){return Object(W.jsxs)(o.a,{children:[Object(W.jsx)(i.a,{variant:"h3",component:"h1",align:"center",children:"TMDB top 500 movies"}),Object(W.jsx)(re,{})]})},se=a(32),oe=Object(j.a)({reducer:Object(se.a)({},v,y)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(W.jsx)(r.a.StrictMode,{children:Object(W.jsx)(d.a,{store:oe,children:Object(W.jsx)(ce,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[69,1,2]]]);
//# sourceMappingURL=main.c257941b.chunk.js.map