(this["webpackJsonptmdb-test-task"]=this["webpackJsonptmdb-test-task"]||[]).push([[0],{67:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),s=a.n(c),o=a(92),i=a(90),u=a(39),d=a(26),l=d.c,g=a(22),j=a(28),b=a(36),m=a.n(b),p=a(42),f="d1266c529d5c989c867acb40d8dab16f",O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t){return setTimeout(t,e)}))};function h(){return(h=Object(p.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(500+2e3*Math.random());case 2:if(!(Math.random()>.6)){e.next=4;break}throw new Error("Error for demonstration purposes - retry loading pressing on the desired page number again");case 4:return e.next=6,fetch("https://api.themoviedb.org/3/movie/top_rated?api_key=".concat(f,"&page=").concat(t));case 6:return a=e.sent,e.next=9,a.json();case 9:if(n=e.sent,200===a.status){e.next=12;break}throw new Error("Failed to load movies, because of [".concat(a.status,"] ").concat(n.status_code," ").concat(n.status_message));case 12:return e.abrupt("return",n.results.map((function(e){return{id:e.id,image:"https://image.tmdb.org/t/p/w300/".concat(e.backdrop_path),title:e.title,rating:e.vote_average,year:e.release_date.substr(0,4)}})));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x,v="movies";!function(e){e[e.IDLE=0]="IDLE",e[e.LOADING=1]="LOADING",e[e.SUCCEEDED=2]="SUCCEEDED",e[e.FAILED=3]="FAILED"}(x||(x={}));var E=Object(g.c)({selectId:function(e){return e.id}}),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.IDLE;return{data:E.getInitialState(),status:e,error:null}},I={currentPageIndex:1,requestedPage:null,pages:{}},y=Object(g.b)("".concat(v,"/fetchMovies"),(function(e){return h.apply(this,arguments)})),D=Object(g.d)({name:v,initialState:I,reducers:{},extraReducers:function(e){e.addCase(y.pending,(function(e,t){var a=t.meta.arg;e.pages[a]||(e.pages[a]=w(x.LOADING)),e.pages[a].status=x.LOADING,e.requestedPage=a})),e.addCase(y.fulfilled,(function(e,t){var a=t.meta.arg,n=e.pages[a];E.addMany(n.data,t.payload),n.status=x.SUCCEEDED,e.requestedPage===a&&(e.currentPageIndex=a)})),e.addCase(y.rejected,(function(e,t){var a=t.meta.arg,n=e.pages[a];n.error=t.error.message||"Request failed",n.status=x.FAILED}))}}).reducer,S=function(e){return e.movies},C=Object(j.a)([S],(function(e){return e.currentPageIndex})),P=Object(j.a)([S],(function(e){return e.requestedPage})),k=Object(j.a)([S,C],(function(e,t){return e.pages[t]||w()})),q=Object(j.a)([S,P],(function(e,t){return"number"===typeof t&&e.pages[t]||w()})),L=Object(j.a)([k],(function(e){return e.status})),N=Object(j.a)([q],(function(e){return e.status})),A=Object(j.a)([q],(function(e){return e.status===x.FAILED?e.error:null})),R=Object(j.a)([k],(function(e){return e.status===x.SUCCEEDED?e.data:E.getInitialState()})),F={selectCurrentPageIndex:C,selectCurrentPageStatus:L,selectMovies:E.getSelectors(R).selectAll,selectRequestedPageError:A,selectRequestedPageIndex:P,selectRequestedPageStatus:N},M=a(87),_=a(93),G=a(88),U=a(89),z=a(3),B=Object(M.a)({root:{flexGrow:1},title:{fontSize:"3vw"},textSecondary:{fontSize:"2vw"},thumbnail:{height:"10vw",backgroundImage:function(e){return"url(".concat(e.image,")")},backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}}),T=function(e){var t=e.data,a=B(t);return Object(z.jsx)(_.a,{marginY:2,children:Object(z.jsxs)(G.a,{className:a.root,container:!0,spacing:2,component:U.a,alignItems:"stretch",children:[Object(z.jsx)(G.a,{item:!0,xs:3,children:Object(z.jsx)(U.a,{className:a.thumbnail,square:!0,variant:"outlined"})}),Object(z.jsxs)(G.a,{item:!0,xs:9,container:!0,direction:"column",justify:"space-between",children:[Object(z.jsx)(G.a,{item:!0,children:Object(z.jsx)(i.a,{variant:"body2",className:a.title,children:t.title})}),Object(z.jsxs)(G.a,{item:!0,container:!0,direction:"row",justify:"space-between",children:[Object(z.jsx)(G.a,{item:!0,children:Object(z.jsxs)(i.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",children:["Year: ",t.year]})}),Object(z.jsx)(G.a,{item:!0,children:Object(z.jsxs)(i.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",align:"right",children:["Rating: ",t.rating]})})]})]})]})})},J=a(94),W=a(38),Y=a(48),H=a(91),$=a(69),K=a(97),Q=a(98),V=Object($.a)({wrapper:{display:"grid",gridTemplateColumns:"30px 1fr"},pagination:{display:"block",margin:"0 auto",width:"fit-content"},requested:{border:"1px solid #eee"}}),X=function(e){var t=e.loading,a=e.requestedPage,n=Object(Y.a)(e,["loading","requestedPage"]),r=V();return Object(z.jsxs)(_.a,{className:r.wrapper,children:[t?Object(z.jsx)(H.a,{size:20}):Object(z.jsx)("div",{}),Object(z.jsx)(Q.a,Object(W.a)({className:r.pagination,siblingCount:2,boundaryCount:2,count:25,shape:"rounded",renderItem:function(e){var t=e.page===a?r.requested:"";return Object(z.jsx)(K.a,Object(W.a)({className:t},e))}},n))]})},Z=a(96),ee=function(){var e=Object(d.b)(),t=l(F.selectCurrentPageIndex),a=l(F.selectMovies),r=l(F.selectCurrentPageStatus),c=l(F.selectRequestedPageIndex),s=l(F.selectRequestedPageStatus),o=l(F.selectRequestedPageError);Object(n.useEffect)((function(){r===x.IDLE&&e(y(t))}),[r,t,e]);var i=Object(n.useState)(!1),g=Object(u.a)(i,2),j=g[0],b=g[1],m=Object(n.useState)("Something went wrong..."),p=Object(u.a)(m,2),f=p[0],O=p[1],h=function(e,t){"clickaway"!==t&&b(!1)};Object(n.useEffect)((function(){s===x.FAILED&&(O(o||"Something went wrong..."),b(!0))}),[c,s,o]);var v=s===x.LOADING,E=Object(z.jsx)(X,{onChange:function(t,a){e(y(a))},page:t,requestedPage:c,loading:v,defaultPage:1});return Object(z.jsxs)(z.Fragment,{children:[E,Object(z.jsx)(J.a,{open:j,autoHideDuration:6e3,onClose:h,children:Object(z.jsx)(Z.a,{onClose:h,severity:"error",children:f})}),r===x.SUCCEEDED&&Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(_.a,{children:a.map((function(e){return Object(z.jsx)(T,{data:e},e.id)}))}),"pagination"]})]})},te=function(){return Object(z.jsxs)(o.a,{children:[Object(z.jsx)(i.a,{variant:"h3",component:"h1",align:"center",children:"TMDB top 500 movies"}),Object(z.jsx)(ee,{})]})},ae=a(31),ne=Object(g.a)({reducer:Object(ae.a)({},v,D)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(z.jsx)(r.a.StrictMode,{children:Object(z.jsx)(d.a,{store:ne,children:Object(z.jsx)(te,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[67,1,2]]]);
//# sourceMappingURL=main.648c6c59.chunk.js.map