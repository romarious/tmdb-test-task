(this["webpackJsonptmdb-test-task"]=this["webpackJsonptmdb-test-task"]||[]).push([[0],{53:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(12),o=a.n(c),i=a(75),s=a(73),u=a(21),d=u.c,l=a(23),j=a(16),b=a(22),g=a(30),m=a.n(g),h=a(33);function f(){return(f=Object(h.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.themoviedb.org/3/movie/top_rated?api_key=".concat("xxx","&page=").concat(t));case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw new Error("Failed to load movies, because of [".concat(a.status,"] ").concat(n.status_code," ").concat(n.status_message));case 8:return e.abrupt("return",n.results.map((function(e){return{id:e.id,image:"https://image.tmdb.org/t/p/w300/".concat(e.backdrop_path),title:e.title,rating:e.vote_average,year:e.release_date.substr(0,4)}})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O,p="movies";!function(e){e[e.IDLE=0]="IDLE",e[e.LOADING=1]="LOADING",e[e.SUCCEEDED=2]="SUCCEEDED",e[e.FAILED=3]="FAILED"}(O||(O={}));var x=Object(j.c)({selectId:function(e){return e.id}}),v=function(){return{data:x.getInitialState(),status:O.IDLE,error:null}},E={currentPage:1,loadingPage:null,pages:Object(l.a)({},1,v())},w=Object(j.b)("".concat(p,"/fetchMovies"),(function(e){return f.apply(this,arguments)})),D=Object(j.d)({name:p,initialState:E,reducers:{},extraReducers:function(e){e.addCase(w.pending,(function(e,t){var a=t.meta.arg;e.pages[a]||(e.pages[a]=v()),e.pages[a].status=O.LOADING,e.loadingPage=a})),e.addCase(w.fulfilled,(function(e,t){var a=t.meta.arg,n=e.pages[a];x.addMany(n.data,t.payload),n.status=O.SUCCEEDED,e.loadingPage===a&&(e.currentPage=a)})),e.addCase(w.rejected,(function(e,t){var a=t.meta.arg,n=e.pages[a];n.error=t.error.message||"Request failed",n.status=O.FAILED}))}}).reducer,y=function(e){return e.movies},I=Object(b.a)([y],(function(e){return e.currentPage})),S=Object(b.a)([y],(function(e){return e.loadingPage})),L=Object(b.a)([y,I],(function(e,t){return e.pages[t]})),C=Object(b.a)([L],(function(e){return e.status})),k=Object(b.a)([L],(function(e){return e.error})),N=Object(b.a)([L],(function(e){return e.data})),P={selectCurrentPageNumber:I,selectLoadingPageNumber:S,selectMovies:x.getSelectors(N).selectAll,selectMoviesLoadError:k,selectMoviesLoadStatus:C},M=a(70),A=a(77),_=a(71),F=a(72),G=a(3),R=Object(M.a)({root:{flexGrow:1},title:{fontSize:"3vw"},textSecondary:{fontSize:"2vw"},thumbnail:{height:"10vw",backgroundImage:function(e){return"url(".concat(e.image,")")},backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}}),U=function(e){var t=e.data,a=R(t);return Object(G.jsx)(A.a,{marginY:2,children:Object(G.jsxs)(_.a,{className:a.root,container:!0,spacing:2,component:F.a,alignItems:"stretch",children:[Object(G.jsx)(_.a,{item:!0,xs:3,children:Object(G.jsx)(F.a,{className:a.thumbnail,square:!0,variant:"outlined"})}),Object(G.jsxs)(_.a,{item:!0,xs:9,container:!0,direction:"column",justify:"space-between",children:[Object(G.jsx)(_.a,{item:!0,children:Object(G.jsx)(s.a,{variant:"body2",className:a.title,children:t.title})}),Object(G.jsxs)(_.a,{item:!0,container:!0,direction:"row",justify:"space-between",children:[Object(G.jsx)(_.a,{item:!0,children:Object(G.jsxs)(s.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",children:["Year: ",t.year]})}),Object(G.jsx)(_.a,{item:!0,children:Object(G.jsxs)(s.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",align:"right",children:["Rating: ",t.rating]})})]})]})]})})},z=a(74),B=a(55),q=Object(B.a)({root:{flexGrow:1,minHeight:"80vh"}}),J=function(){var e=q();return Object(G.jsx)(_.a,{className:e.root,container:!0,direction:"row",justify:"center",alignItems:"center",children:Object(G.jsx)(z.a,{})})},W=a(76),Y=Object(B.a)({pagination:{margin:"0 auto",width:"fit-content"}}),H=function(){var e=Y(),t=Object(u.b)(),a=d(P.selectCurrentPageNumber),r=d(P.selectMovies),c=d(P.selectMoviesLoadStatus),o=d(P.selectMoviesLoadError);Object(n.useEffect)((function(){c===O.IDLE&&t(w(a))}),[c,a,t]);return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(W.a,{className:e.pagination,siblingCount:2,boundaryCount:2,count:25,shape:"rounded",onChange:function(e,a){t(w(a))},page:a,defaultPage:1}),(c===O.IDLE||c===O.LOADING)&&Object(G.jsx)(J,{}),c===O.FAILED&&Object(G.jsx)(s.a,{variant:"h3",align:"center",color:"error",children:o||"Something went wrong..."}),c===O.SUCCEEDED&&Object(G.jsx)(A.a,{children:r.map((function(e){return Object(G.jsx)(U,{data:e},e.id)}))})]})},T=function(){return Object(G.jsxs)(i.a,{children:[Object(G.jsx)(s.a,{variant:"h3",component:"h1",align:"center",children:"TMDB top 500 movies"}),Object(G.jsx)(H,{})]})},$=Object(j.a)({reducer:Object(l.a)({},p,D)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(G.jsx)(r.a.StrictMode,{children:Object(G.jsx)(u.a,{store:$,children:Object(G.jsx)(T,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.df257c66.chunk.js.map