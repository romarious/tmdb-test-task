(this["webpackJsonptmdb-test-task"]=this["webpackJsonptmdb-test-task"]||[]).push([[0],{53:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(12),o=a.n(c),i=a(75),s=a(73),u=a(21),d=u.c,l=a(23),b=a(16),j=a(22),g=a(30),m=a.n(g),h=a(33),f="d1266c529d5c989c867acb40d8dab16f";function O(){return(O=Object(h.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.themoviedb.org/3/movie/top_rated?api_key=".concat(f,"&page=").concat(t));case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw new Error("Failed to load movies, because of [".concat(a.status,"] ").concat(n.status_code," ").concat(n.status_message));case 8:return e.abrupt("return",n.results.map((function(e){return{id:e.id,image:"https://image.tmdb.org/t/p/w300/".concat(e.backdrop_path),title:e.title,rating:e.vote_average,year:e.release_date.substr(0,4)}})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p,v="movies";!function(e){e[e.IDLE=0]="IDLE",e[e.LOADING=1]="LOADING",e[e.SUCCEEDED=2]="SUCCEEDED",e[e.FAILED=3]="FAILED"}(p||(p={}));var x=Object(b.c)({selectId:function(e){return e.id}}),E=function(){return{data:x.getInitialState(),status:p.IDLE,error:null}},w={currentPage:1,loadingPage:null,pages:Object(l.a)({},1,E())},D=Object(b.b)("".concat(v,"/fetchMovies"),(function(e){return O.apply(this,arguments)})),y=Object(b.d)({name:v,initialState:w,reducers:{},extraReducers:function(e){e.addCase(D.pending,(function(e,t){var a=t.meta.arg;e.pages[a]||(e.pages[a]=E()),e.pages[a].status=p.LOADING,e.loadingPage=a})),e.addCase(D.fulfilled,(function(e,t){var a=t.meta.arg,n=e.pages[a];x.addMany(n.data,t.payload),n.status=p.SUCCEEDED,e.loadingPage===a&&(e.currentPage=a)})),e.addCase(D.rejected,(function(e,t){var a=t.meta.arg,n=e.pages[a];n.error=t.error.message||"Request failed",n.status=p.FAILED}))}}).reducer,I=function(e){return e.movies},S=Object(j.a)([I],(function(e){return e.currentPage})),L=Object(j.a)([I],(function(e){return e.loadingPage})),C=Object(j.a)([I,S],(function(e,t){return e.pages[t]})),k=Object(j.a)([C],(function(e){return e.status})),N=Object(j.a)([C],(function(e){return e.error})),P=Object(j.a)([C],(function(e){return e.data})),M={selectCurrentPageNumber:S,selectLoadingPageNumber:L,selectMovies:x.getSelectors(P).selectAll,selectMoviesLoadError:N,selectMoviesLoadStatus:k},A=a(70),_=a(77),F=a(71),G=a(72),R=a(3),U=Object(A.a)({root:{flexGrow:1},title:{fontSize:"3vw"},textSecondary:{fontSize:"2vw"},thumbnail:{height:"10vw",backgroundImage:function(e){return"url(".concat(e.image,")")},backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}}),z=function(e){var t=e.data,a=U(t);return Object(R.jsx)(_.a,{marginY:2,children:Object(R.jsxs)(F.a,{className:a.root,container:!0,spacing:2,component:G.a,alignItems:"stretch",children:[Object(R.jsx)(F.a,{item:!0,xs:3,children:Object(R.jsx)(G.a,{className:a.thumbnail,square:!0,variant:"outlined"})}),Object(R.jsxs)(F.a,{item:!0,xs:9,container:!0,direction:"column",justify:"space-between",children:[Object(R.jsx)(F.a,{item:!0,children:Object(R.jsx)(s.a,{variant:"body2",className:a.title,children:t.title})}),Object(R.jsxs)(F.a,{item:!0,container:!0,direction:"row",justify:"space-between",children:[Object(R.jsx)(F.a,{item:!0,children:Object(R.jsxs)(s.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",children:["Year: ",t.year]})}),Object(R.jsx)(F.a,{item:!0,children:Object(R.jsxs)(s.a,{variant:"body2",className:a.textSecondary,color:"textSecondary",align:"right",children:["Rating: ",t.rating]})})]})]})]})})},B=a(74),q=a(55),J=Object(q.a)({root:{flexGrow:1,minHeight:"80vh"}}),W=function(){var e=J();return Object(R.jsx)(F.a,{className:e.root,container:!0,direction:"row",justify:"center",alignItems:"center",children:Object(R.jsx)(B.a,{})})},Y=a(76),H=Object(q.a)({pagination:{margin:"0 auto",width:"fit-content"}}),T=function(){var e=H(),t=Object(u.b)(),a=d(M.selectCurrentPageNumber),r=d(M.selectMovies),c=d(M.selectMoviesLoadStatus),o=d(M.selectMoviesLoadError);Object(n.useEffect)((function(){c===p.IDLE&&t(D(a))}),[c,a,t]);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Y.a,{className:e.pagination,siblingCount:2,boundaryCount:2,count:25,shape:"rounded",onChange:function(e,a){t(D(a))},page:a,defaultPage:1}),(c===p.IDLE||c===p.LOADING)&&Object(R.jsx)(W,{}),c===p.FAILED&&Object(R.jsx)(s.a,{variant:"h3",align:"center",color:"error",children:o||"Something went wrong..."}),c===p.SUCCEEDED&&Object(R.jsx)(_.a,{children:r.map((function(e){return Object(R.jsx)(z,{data:e},e.id)}))})]})},$=function(){return Object(R.jsxs)(i.a,{children:[Object(R.jsx)(s.a,{variant:"h3",component:"h1",align:"center",children:"TMDB top 500 movies"}),Object(R.jsx)(T,{})]})},K=Object(b.a)({reducer:Object(l.a)({},v,y)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(R.jsx)(r.a.StrictMode,{children:Object(R.jsx)(u.a,{store:K,children:Object(R.jsx)($,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.4b36e1d6.chunk.js.map